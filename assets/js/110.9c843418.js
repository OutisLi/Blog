(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{472:function(e,r,t){"use strict";t.r(r);var o=t(14),n=Object(o.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"_03-💽-制作自己的镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_03-💽-制作自己的镜像"}},[e._v("#")]),e._v(" 03. 💽 制作自己的镜像")]),e._v(" "),r("h3",{attrs:{id:"为自己的-web-项目构建镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#为自己的-web-项目构建镜像"}},[e._v("#")]),e._v(" 为自己的 Web 项目构建镜像")]),e._v(" "),r("p",[e._v("示例项目代码："),r("a",{attrs:{href:"https://github.com/gzyunke/test-docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/gzyunke/test-docker"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("这是一个 Nodejs + Koa2 写的 Web 项目，提供了简单的两个演示页面。")]),e._v(" "),r("p",[e._v("软件依赖："),r("a",{attrs:{href:"https://nodejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[e._v("nodejs"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("项目依赖库：koa、log4js、koa-router")]),e._v(" "),r("blockquote",[r("p",[e._v("本文档课件配套 视频教程")])]),e._v(" "),r("h3",{attrs:{id:"编写-dockerfile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#编写-dockerfile"}},[e._v("#")]),e._v(" 编写 Dockerfile")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("FROM node:11\nMAINTAINER easydoc.net\n\n# 复制代码\nADD . /app\n\n# 设置容器启动后的默认运行目录\nWORKDIR /app\n\n# 运行命令，安装依赖\n# RUN 命令可以有多个，但是可以用 && 连接多个命令来减少层级。\n# 例如 RUN npm install && cd /app && mkdir logs\nRUN npm install --registry=https://registry.npm.taobao.org\n\n# CMD 指令只能一个，是容器启动后执行的命令，算是程序的入口。\n# 如果还需要运行其他命令可以用 && 连接，也可以写成一个shell脚本去执行。\n# 例如 CMD cd /app && ./start.sh\nCMD node app.js\n")])])]),r("p",[r("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#run",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dockerfile文档"),r("OutboundLink")],1)]),e._v(" "),r("blockquote",[r("p",[e._v("实用技巧：")]),e._v(" "),r("p",[e._v("如果你写 Dockerfile 时经常遇到一些运行错误，依赖错误等，你可以直接运行一个依赖的底，然后进入终端进行配置环境，成功后再把做过的步骤命令写道 Dockerfile 文件中，这样编写调试会快很多。")]),e._v(" "),r("p",[e._v("例如上面的底是"),r("code",[e._v("node:11")]),e._v("，我们可以运行"),r("code",[e._v("docker run -it -d node:11 bash")]),e._v("，跑起来后进入容器终端配置依赖的软件，然后尝试跑起来自己的软件，最后把所有做过的步骤写入到 Dockerfile 就好了。")]),e._v(" "),r("p",[e._v("掌握好这个技巧，你的 Dockerfile 文件编写起来就非常的得心应手了。")])]),e._v(" "),r("h3",{attrs:{id:"build-为镜像-安装包-和运行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#build-为镜像-安装包-和运行"}},[e._v("#")]),e._v(" Build 为镜像（安装包）和运行")]),e._v(" "),r("p",[e._v("编译 "),r("code",[e._v("docker build -t test:v1 .")])]),e._v(" "),r("blockquote",[r("p",[e._v("-t 设置镜像名字和版本号")]),e._v(" "),r("p",[e._v("命令参考："),r("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/build/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.docker.com/engine/reference/commandline/build/"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("运行 "),r("code",[e._v("docker run -p 8080:8080 --name test-hello test:v1")])]),e._v(" "),r("blockquote",[r("p",[e._v("-p 映射容器内端口到宿主机")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("-name")]),e._v(" 容器名字")]),e._v(" "),r("li",[r("code",[e._v("d")]),e._v(" 后台运行")])]),e._v(" "),r("p",[e._v("命令参考文档："),r("a",{attrs:{href:"https://docs.docker.com/engine/reference/run/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.docker.com/engine/reference/run/"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"更多相关命令"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#更多相关命令"}},[e._v("#")]),e._v(" 更多相关命令")]),e._v(" "),r("p",[r("code",[e._v("docker ps")]),e._v(" 查看当前运行中的容器")]),e._v(" "),r("p",[r("code",[e._v("docker images")]),e._v(" 查看镜像列表")]),e._v(" "),r("p",[r("code",[e._v("docker rm container-id")]),e._v(" 删除指定 id 的容器")]),e._v(" "),r("p",[r("code",[e._v("docker stop/start container-id")]),e._v(" 停止/启动指定 id 的容器")]),e._v(" "),r("p",[r("code",[e._v("docker rmi image-id")]),e._v(" 删除指定 id 的镜像")]),e._v(" "),r("p",[r("code",[e._v("docker volume ls")]),e._v(" 查看 volume 列表")]),e._v(" "),r("p",[r("code",[e._v("docker network ls")]),e._v(" 查看网络列表")])])}),[],!1,null,null,null);r.default=n.exports}}]);