(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{474:function(e,o,r){"use strict";r.r(o);var s=r(14),c=Object(s.a)({},(function(){var e=this,o=e._self._c;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"_06-🍁-docker-compose"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_06-🍁-docker-compose"}},[e._v("#")]),e._v(" 06. 🍁 Docker-Compose")]),e._v(" "),o("h3",{attrs:{id:"现存问题"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#现存问题"}},[e._v("#")]),e._v(" 现存问题")]),e._v(" "),o("p",[e._v("在上节，我们运行了两个容器：Web 项目 + Redis")]),e._v(" "),o("p",[e._v("如果项目依赖更多的第三方软件，我们需要管理的容器就更加多，每个都要单独配置运行，指定网络。")]),e._v(" "),o("p",[e._v("这节，我们使用 docker-compose 把项目的多个服务集合到一起，一键运行。")]),e._v(" "),o("blockquote",[o("p",[e._v("本文档课件配套 视频教程")])]),e._v(" "),o("h3",{attrs:{id:"安装-docker-compose"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker-compose"}},[e._v("#")]),e._v(" 安装 Docker Compose")]),e._v(" "),o("ul",[o("li",[e._v("如果你是安装的桌面版 Docker，不需要额外安装，已经包含了。")]),e._v(" "),o("li",[e._v("如果是没图形界面的服务器版 Docker，你需要单独安装 "),o("a",{attrs:{href:"https://docs.docker.com/compose/install/#install-compose-on-linux-systems",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装文档"),o("OutboundLink")],1)]),e._v(" "),o("li",[e._v("运行"),o("code",[e._v("docker-compose")]),e._v("检查是否安装成功")])]),e._v(" "),o("h3",{attrs:{id:"编写脚本"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#编写脚本"}},[e._v("#")]),e._v(" 编写脚本")]),e._v(" "),o("p",[e._v("要把项目依赖的多个服务集合到一起，我们需要编写一个"),o("code",[e._v("docker-compose.yml")]),e._v("文件，描述依赖哪些服务")]),e._v(" "),o("p",[e._v("参考文档："),o("a",{attrs:{href:"https://docs.docker.com/compose/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.docker.com/compose/"),o("OutboundLink")],1)]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v('version: "3.7"\n\nservices:\n  app:\n    build: ./\n    ports:\n      - 80:8080\n    volumes:\n      - ./:/app\n    environment:\n      - TZ=Asia/Shanghai\n  redis:\n    image: redis:5.0.13\n    volumes:\n      - redis:/data\n    environment:\n      - TZ=Asia/Shanghai\n\nvolumes:\n  redis:\n')])])]),o("blockquote",[o("p",[e._v("容器默认时间不是北京时间，增加 TZ=Asia/Shanghai 可以改为北京时间")])]),e._v(" "),o("h3",{attrs:{id:"跑起来"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#跑起来"}},[e._v("#")]),e._v(" 跑起来")]),e._v(" "),o("p",[e._v("在"),o("code",[e._v("docker-compose.yml")]),e._v(" 文件所在目录，执行："),o("code",[e._v("docker-compose up")]),e._v("就可以跑起来了。")]),e._v(" "),o("p",[e._v("命令参考："),o("a",{attrs:{href:"https://docs.docker.com/compose/reference/up/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.docker.com/compose/reference/up/"),o("OutboundLink")],1)]),e._v(" "),o("p",[e._v("在后台运行只需要加一个 -d 参数"),o("code",[e._v("docker-compose up -d")])]),e._v(" "),o("p",[e._v("查看运行状态："),o("code",[e._v("docker-compose ps")])]),e._v(" "),o("p",[e._v("停止运行："),o("code",[e._v("docker-compose stop")])]),e._v(" "),o("p",[e._v("重启："),o("code",[e._v("docker-compose restart")])]),e._v(" "),o("p",[e._v("重启单个服务："),o("code",[e._v("docker-compose restart service-name")])]),e._v(" "),o("p",[e._v("进入容器命令行："),o("code",[e._v("docker-compose exec service-name sh")])]),e._v(" "),o("p",[e._v("查看容器运行log："),o("code",[e._v("docker-compose logs [service-name]")])])])}),[],!1,null,null,null);o.default=c.exports}}]);