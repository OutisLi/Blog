<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2023.09.05-C++ Trim 程序 | Personal Blog --from Outis Li</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.9501ef99.css" as="style"><link rel="preload" href="/Blog/assets/js/app.fffc62c2.js" as="script"><link rel="preload" href="/Blog/assets/js/2.d9b38520.js" as="script"><link rel="preload" href="/Blog/assets/js/1.a4e52cf6.js" as="script"><link rel="preload" href="/Blog/assets/js/106.72dc4a51.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.c8b6361b.js"><link rel="prefetch" href="/Blog/assets/js/100.31d8a184.js"><link rel="prefetch" href="/Blog/assets/js/101.43f73921.js"><link rel="prefetch" href="/Blog/assets/js/102.5ed282f0.js"><link rel="prefetch" href="/Blog/assets/js/103.38126020.js"><link rel="prefetch" href="/Blog/assets/js/104.18a97c2e.js"><link rel="prefetch" href="/Blog/assets/js/105.0e28206e.js"><link rel="prefetch" href="/Blog/assets/js/107.4f8bc33d.js"><link rel="prefetch" href="/Blog/assets/js/108.9a2b3df8.js"><link rel="prefetch" href="/Blog/assets/js/109.acce4c89.js"><link rel="prefetch" href="/Blog/assets/js/11.1a662648.js"><link rel="prefetch" href="/Blog/assets/js/110.9c843418.js"><link rel="prefetch" href="/Blog/assets/js/111.5588d5e5.js"><link rel="prefetch" href="/Blog/assets/js/112.e2a0c013.js"><link rel="prefetch" href="/Blog/assets/js/113.1d702661.js"><link rel="prefetch" href="/Blog/assets/js/114.ea11a3c7.js"><link rel="prefetch" href="/Blog/assets/js/115.07cb358a.js"><link rel="prefetch" href="/Blog/assets/js/12.eccfbbbe.js"><link rel="prefetch" href="/Blog/assets/js/13.931bd67a.js"><link rel="prefetch" href="/Blog/assets/js/14.2bf74249.js"><link rel="prefetch" href="/Blog/assets/js/15.339e7fa7.js"><link rel="prefetch" href="/Blog/assets/js/16.198e4ae3.js"><link rel="prefetch" href="/Blog/assets/js/17.8071f72f.js"><link rel="prefetch" href="/Blog/assets/js/18.3d9ea382.js"><link rel="prefetch" href="/Blog/assets/js/19.831e14a0.js"><link rel="prefetch" href="/Blog/assets/js/20.9b49ec2d.js"><link rel="prefetch" href="/Blog/assets/js/21.1ec03a46.js"><link rel="prefetch" href="/Blog/assets/js/22.a17f69b5.js"><link rel="prefetch" href="/Blog/assets/js/23.883f4d72.js"><link rel="prefetch" href="/Blog/assets/js/24.288d26b1.js"><link rel="prefetch" href="/Blog/assets/js/25.8382691f.js"><link rel="prefetch" href="/Blog/assets/js/26.b16a0955.js"><link rel="prefetch" href="/Blog/assets/js/27.48df2183.js"><link rel="prefetch" href="/Blog/assets/js/28.78a93a22.js"><link rel="prefetch" href="/Blog/assets/js/29.35173b18.js"><link rel="prefetch" href="/Blog/assets/js/3.2e411533.js"><link rel="prefetch" href="/Blog/assets/js/30.399eb7e0.js"><link rel="prefetch" href="/Blog/assets/js/31.b3883f92.js"><link rel="prefetch" href="/Blog/assets/js/32.41cbba68.js"><link rel="prefetch" href="/Blog/assets/js/33.8c7dad02.js"><link rel="prefetch" href="/Blog/assets/js/34.14dbba3c.js"><link rel="prefetch" href="/Blog/assets/js/35.4f3f9027.js"><link rel="prefetch" href="/Blog/assets/js/36.fb0febbe.js"><link rel="prefetch" href="/Blog/assets/js/37.4389234d.js"><link rel="prefetch" href="/Blog/assets/js/38.8ed5cb63.js"><link rel="prefetch" href="/Blog/assets/js/39.737bc7aa.js"><link rel="prefetch" href="/Blog/assets/js/4.fb4fd8cb.js"><link rel="prefetch" href="/Blog/assets/js/40.a8f08a39.js"><link rel="prefetch" href="/Blog/assets/js/41.9bf43c30.js"><link rel="prefetch" href="/Blog/assets/js/42.a0c00c32.js"><link rel="prefetch" href="/Blog/assets/js/43.a0c5e0dc.js"><link rel="prefetch" href="/Blog/assets/js/44.5c5a7720.js"><link rel="prefetch" href="/Blog/assets/js/45.5cf2d723.js"><link rel="prefetch" href="/Blog/assets/js/46.9bf39433.js"><link rel="prefetch" href="/Blog/assets/js/47.3160d2d2.js"><link rel="prefetch" href="/Blog/assets/js/48.9fa80ad1.js"><link rel="prefetch" href="/Blog/assets/js/49.936e67cd.js"><link rel="prefetch" href="/Blog/assets/js/5.936fe44f.js"><link rel="prefetch" href="/Blog/assets/js/50.4697b95b.js"><link rel="prefetch" href="/Blog/assets/js/51.ac66a436.js"><link rel="prefetch" href="/Blog/assets/js/52.d4c332c8.js"><link rel="prefetch" href="/Blog/assets/js/53.c9523c0d.js"><link rel="prefetch" href="/Blog/assets/js/54.1eaf6097.js"><link rel="prefetch" href="/Blog/assets/js/55.0890672b.js"><link rel="prefetch" href="/Blog/assets/js/56.05a29d48.js"><link rel="prefetch" href="/Blog/assets/js/57.33d78bd1.js"><link rel="prefetch" href="/Blog/assets/js/58.b459354c.js"><link rel="prefetch" href="/Blog/assets/js/59.9c73fddf.js"><link rel="prefetch" href="/Blog/assets/js/6.78a547ee.js"><link rel="prefetch" href="/Blog/assets/js/60.7299e19c.js"><link rel="prefetch" href="/Blog/assets/js/61.14b5149d.js"><link rel="prefetch" href="/Blog/assets/js/62.9d7660e9.js"><link rel="prefetch" href="/Blog/assets/js/63.5d1e8d84.js"><link rel="prefetch" href="/Blog/assets/js/64.0a735136.js"><link rel="prefetch" href="/Blog/assets/js/65.d8b81a24.js"><link rel="prefetch" href="/Blog/assets/js/66.cae6262d.js"><link rel="prefetch" href="/Blog/assets/js/67.2e380607.js"><link rel="prefetch" href="/Blog/assets/js/68.60ad3ba4.js"><link rel="prefetch" href="/Blog/assets/js/69.02f55698.js"><link rel="prefetch" href="/Blog/assets/js/7.21716967.js"><link rel="prefetch" href="/Blog/assets/js/70.194f0590.js"><link rel="prefetch" href="/Blog/assets/js/71.ee7d9bfb.js"><link rel="prefetch" href="/Blog/assets/js/72.43af9dd4.js"><link rel="prefetch" href="/Blog/assets/js/73.973c695f.js"><link rel="prefetch" href="/Blog/assets/js/74.c2b70d6c.js"><link rel="prefetch" href="/Blog/assets/js/75.a359e09d.js"><link rel="prefetch" href="/Blog/assets/js/76.c39b2efa.js"><link rel="prefetch" href="/Blog/assets/js/77.a5f949cf.js"><link rel="prefetch" href="/Blog/assets/js/78.6bd57e21.js"><link rel="prefetch" href="/Blog/assets/js/79.7cd9d8f4.js"><link rel="prefetch" href="/Blog/assets/js/80.a67aaeeb.js"><link rel="prefetch" href="/Blog/assets/js/81.828cb38e.js"><link rel="prefetch" href="/Blog/assets/js/82.37554809.js"><link rel="prefetch" href="/Blog/assets/js/83.0064504d.js"><link rel="prefetch" href="/Blog/assets/js/84.dd48bb56.js"><link rel="prefetch" href="/Blog/assets/js/85.f2cafb4b.js"><link rel="prefetch" href="/Blog/assets/js/86.f670b220.js"><link rel="prefetch" href="/Blog/assets/js/87.46382599.js"><link rel="prefetch" href="/Blog/assets/js/88.c3f9ed96.js"><link rel="prefetch" href="/Blog/assets/js/89.f2e32b85.js"><link rel="prefetch" href="/Blog/assets/js/90.3b1cd03d.js"><link rel="prefetch" href="/Blog/assets/js/91.6a37ce11.js"><link rel="prefetch" href="/Blog/assets/js/92.6ba751dd.js"><link rel="prefetch" href="/Blog/assets/js/93.036c2667.js"><link rel="prefetch" href="/Blog/assets/js/94.5e1af68e.js"><link rel="prefetch" href="/Blog/assets/js/95.7faaf930.js"><link rel="prefetch" href="/Blog/assets/js/96.d8b18168.js"><link rel="prefetch" href="/Blog/assets/js/97.4e7ad107.js"><link rel="prefetch" href="/Blog/assets/js/98.b741819f.js"><link rel="prefetch" href="/Blog/assets/js/99.c01eca41.js"><link rel="prefetch" href="/Blog/assets/js/vendors~docsearch.3b28fe31.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.9501ef99.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><img src="/Blog/assets/img/good.png" alt="Personal Blog --from Outis Li" class="logo"> <span class="site-name can-hide">Personal Blog --from Outis Li</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Research" class="dropdown-title"><span class="title">Research</span> <span class="arrow down"></span></button> <button type="button" aria-label="Research" class="mobile-dropdown-title"><span class="title">Research</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/Research/Research/2023-Geant4.html" class="nav-link">
  Geant4
</a></li><li class="dropdown-item"><h4>
          CS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Research/Research/2023.12.12-Docker.html" class="nav-link">
  Docker
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="LeetCode" class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow down"></span></button> <button type="button" aria-label="LeetCode" class="mobile-dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.02.22-BFS.html" class="nav-link">
  BFS
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.05-二叉树.html" class="nav-link">
  二叉树
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.11-二分搜索.html" class="nav-link">
  二分搜索
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.18-滑动窗口.html" class="nav-link">
  滑动窗口
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Chip" class="dropdown-title"><span class="title">Chip</span> <span class="arrow down"></span></button> <button type="button" aria-label="Chip" class="mobile-dropdown-title"><span class="title">Chip</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          一生一芯
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  预学习
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  B阶段
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  A阶段
</a></li></ul></li><li class="dropdown-item"><h4>
          Chisel
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  Outline
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2024.02.21-Chisel/2024.02.21-ChiselBoot.html" class="nav-link">
  Bootcamp
</a></li></ul></li><li class="dropdown-item"><h4>
          Verilog
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  Outline
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  Basic
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2024.02.21-Chisel/2024.02.21-ChiselBoot.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Research" class="dropdown-title"><span class="title">Research</span> <span class="arrow down"></span></button> <button type="button" aria-label="Research" class="mobile-dropdown-title"><span class="title">Research</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/Research/Research/2023-Geant4.html" class="nav-link">
  Geant4
</a></li><li class="dropdown-item"><h4>
          CS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Research/Research/2023.12.12-Docker.html" class="nav-link">
  Docker
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="LeetCode" class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow down"></span></button> <button type="button" aria-label="LeetCode" class="mobile-dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.02.22-BFS.html" class="nav-link">
  BFS
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.05-二叉树.html" class="nav-link">
  二叉树
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.11-二分搜索.html" class="nav-link">
  二分搜索
</a></li><li class="dropdown-subitem"><a href="/Blog/LeetCode/Leetcode/2024.03.18-滑动窗口.html" class="nav-link">
  滑动窗口
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Chip" class="dropdown-title"><span class="title">Chip</span> <span class="arrow down"></span></button> <button type="button" aria-label="Chip" class="mobile-dropdown-title"><span class="title">Chip</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          一生一芯
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  预学习
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  B阶段
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  A阶段
</a></li></ul></li><li class="dropdown-item"><h4>
          Chisel
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  Outline
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2024.02.21-Chisel/2024.02.21-ChiselBoot.html" class="nav-link">
  Bootcamp
</a></li></ul></li><li class="dropdown-item"><h4>
          Verilog
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  Outline
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  Basic
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others" class="mobile-dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/1. 一生一芯计划.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2024.02.21-Chisel/2024.02.21-ChiselBoot.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/2. 2024.02.21-Chisel.html" class="nav-link">
  tbc
</a></li></ul></li><li class="dropdown-item"><h4>
          tbc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li><li class="dropdown-subitem"><a href="/Blog/Chip/Chip/3. 2023.11.07-Verilog语法.html" class="nav-link">
  tbc
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2023 Geant4</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/Research/Research/2023-Geant4/2023.02.13-在超算上搭建Singularity环境并配置Geant4.html" class="sidebar-link">2023.02.13-在超算上搭建Singularity环境并配置Geant4</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.02.27-处理Geant4获取的数据.html" class="sidebar-link">2023.02.27-处理Geant4获取的数据</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.03.12-PKA数据处理.html" class="sidebar-link">2023.03.12-PKA数据处理</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.05.23-Geant4多粒子源设置.html" class="sidebar-link">2023.05.23-Geant4多粒子源设置</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.06.14-Geant4各版本的安装.html" class="sidebar-link">2023.06.14-Geant4各版本的安装</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.08.28-Geant4自定义PhysicsList.html" class="sidebar-link">2023.08.28-Geant4 自定义 PhysicsList</a></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html" class="active sidebar-link">2023.09.05-C++ Trim 程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#每个粒子端到端的计算" class="sidebar-link">每个粒子端到端的计算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#initialion" class="sidebar-link">InitialIon()</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#具体计算" class="sidebar-link">具体计算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_1-freelength" class="sidebar-link">1. FreeLength()</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用到的变量" class="sidebar-link">使用到的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#输出-改变-的变量" class="sidebar-link">输出（改变）的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_2-chosecollisionatom" class="sidebar-link">2. ChoseCollisionAtom()</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用到的变量-2" class="sidebar-link">使用到的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量" class="sidebar-link">改变的变量：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_3-eleenergyloss" class="sidebar-link">3. EleEnergyLoss()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用的变量" class="sidebar-link">使用的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量-2" class="sidebar-link">改变的变量：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_4-emissionangle" class="sidebar-link">4. EmissionAngle()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用的变量-2" class="sidebar-link">使用的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量-3" class="sidebar-link">改变的变量：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_5-ionnewcondition" class="sidebar-link">5. IonNewCondition()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用的变量-3" class="sidebar-link">使用的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量-4" class="sidebar-link">改变的变量：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_6-processrecorder" class="sidebar-link">6. ProcessRecorder()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用的变量-4" class="sidebar-link">使用的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量-5" class="sidebar-link">改变的变量：</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#_7-outornot-int-ionflag" class="sidebar-link">7. OutOrNot(int &amp;Ionflag)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#使用的变量-5" class="sidebar-link">使用的变量：</a></li><li class="sidebar-sub-header"><a href="/Blog/Research/Research/2023-Geant4/2023.09.05-C++ Trim程序.html#改变的变量-6" class="sidebar-link">改变的变量：</a></li></ul></li></ul></li><li><a href="/Blog/Research/Research/2023-Geant4/2023.12.18-Geant4自动化.html" class="sidebar-link">2023.12.18-Geant4自动化</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2023-09-05-c-trim-程序"><a href="#_2023-09-05-c-trim-程序" class="header-anchor">#</a> 2023.09.05-C++ Trim 程序</h1> <h2 id="每个粒子端到端的计算"><a href="#每个粒子端到端的计算" class="header-anchor">#</a> 每个粒子端到端的计算</h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">DoOneIon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> IonFlag<span class="token punctuation">;</span>
	<span class="token comment">// init the orginal paramters for current ions</span>
	<span class="token function">InitialIon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	IonFlag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>IonFlag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// the current ion are under processing</span>
	<span class="token punctuation">{</span>
		<span class="token function">FreeLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ChoseCollisionAtom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">EleEnergyLoss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">EmissionAngle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">IonNewCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ProcessRecorder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">OutOrNot</span><span class="token punctuation">(</span>IonFlag<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token comment">// end of one ions</span>

	<span class="token function">CollisionRecording</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add the results of this ion to the recording arraies</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="initialion"><a href="#initialion" class="header-anchor">#</a> <code>InitialIon()</code></h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">InitialIon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

	E <span class="token operator">=</span> IonEnergyEV<span class="token punctuation">;</span>	<span class="token comment">// Energy</span>
	COSIN <span class="token operator">=</span> <span class="token function">cos</span><span class="token punctuation">(</span>ALPHA<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// direction to the normal</span>
	SINY <span class="token operator">=</span> COSIN<span class="token punctuation">;</span>

	SINE <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>ALPHA<span class="token punctuation">)</span><span class="token punctuation">;</span>
	COSY <span class="token operator">=</span> SINE<span class="token punctuation">;</span>

	CurrentLayer <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	IonWayLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	IonCollisionNo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	X <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	Y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="具体计算"><a href="#具体计算" class="header-anchor">#</a> 具体计算</h2> <h3 id="_1-freelength"><a href="#_1-freelength" class="header-anchor">#</a> 1. <code>FreeLength()</code></h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">FreeLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">float</span> tempvalue<span class="token punctuation">;</span>

	<span class="token comment">// when the ion energy is high</span>
	IonCollisionNo<span class="token operator">++</span><span class="token punctuation">;</span>
	ReducedCollEnergy <span class="token operator">=</span> E <span class="token operator">*</span> F<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">;</span>
	EEG <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>ReducedCollEnergy <span class="token operator">*</span> EPSDG<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	PMAX<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span>EEG <span class="token operator">+</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>EEG<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.125</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>EEG<span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	IonFreeLength <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token punctuation">(</span>PI <span class="token operator">*</span> PMAX<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">*</span> PMAX<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">*</span> ARHO<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// when the ion enrgy is low</span>

	tempvalue <span class="token operator">=</span> <span class="token function">PKURandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>IonCollisionNo <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
		IonFreeLength <span class="token operator">=</span> tempvalue <span class="token operator">*</span> <span class="token function">AMIN1</span><span class="token punctuation">(</span>IonFreeLength<span class="token punctuation">,</span> channelwidth<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> IonFreeLength<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>ReducedCollEnergy</code>: 同样表示与被选中的原子碰撞后的&quot;减少的&quot;能量。</li> <li><code>E</code>: 未定义在这个函数中，但似乎是离子或粒子的能量。</li> <li><code>F[CurrentLayer]</code>: 当前层对应的一个因子，用于计算<code>ReducedCollEnergy</code>。</li> <li><code>EEG</code>: 一个与<code>ReducedCollEnergy</code>和<code>EPSDG[CurrentLayer]</code>有关的参数。</li> <li><code>EPSDG[CurrentLayer]</code>: 与当前层有关的一个常数或参数。</li> <li><code>PMAX[CurrentLayer]</code>: 当前层中的最大动量或概率。</li> <li><code>A[CurrentLayer]</code>: 当前层对应的一个参数或常数。</li> <li><code>IonFreeLength</code>: 离子的自由路径长度。</li> <li><code>ARHO[CurrentLayer]</code>: 当前层的密度或者与密度相关的一个参数。</li> <li><code>channelwidth</code>: 一个与离子自由路径长度有关的参数或者常数。</li></ul> <h3 id="使用到的变量"><a href="#使用到的变量" class="header-anchor">#</a> 使用到的变量：</h3> <p><code>E</code>, <code>F</code>, <code>EPSDG</code>, <code>A</code>, <code>ARHO</code></p> <h3 id="输出-改变-的变量"><a href="#输出-改变-的变量" class="header-anchor">#</a> 输出（改变）的变量：</h3> <p><code>IonCollisionNo</code>, <code>ReducedCollEnergy</code>, <code>IonFreeLength</code>, <code>PMAX</code></p> <h3 id="_2-chosecollisionatom"><a href="#_2-chosecollisionatom" class="header-anchor">#</a> 2. <code>ChoseCollisionAtom()</code></h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">ChoseCollisionAtom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

	<span class="token keyword">int</span> MaxElement<span class="token punctuation">;</span>
	<span class="token keyword">float</span> tempRandValue<span class="token punctuation">;</span>

	tempRandValue <span class="token operator">=</span> <span class="token function">PKURandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>tempRandValue <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		tempRandValue <span class="token operator">=</span> <span class="token function">PKURandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	P <span class="token operator">=</span> PMAX<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>tempRandValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
	MaxElement <span class="token operator">=</span> LayerElementNo<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// decided which kinds of atoms to be knocked!</span>

	tempRandValue <span class="token operator">=</span> <span class="token function">PKURandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>CurrentElement <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> CurrentElement <span class="token operator">&lt;=</span> MaxElement<span class="token punctuation">;</span> CurrentElement<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		tempRandValue <span class="token operator">=</span> tempRandValue <span class="token operator">-</span> TargetAtomConc<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tempRandValue <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tempRandValue <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		CurrentElement <span class="token operator">=</span> LayerElementNo<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">;</span>

	ReducedCollEnergy <span class="token operator">=</span> FItemp<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span> <span class="token operator">*</span> E<span class="token punctuation">;</span>
	B <span class="token operator">=</span> P <span class="token operator">/</span> ScreenLen<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TargetAtomNumber<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>P</code>: 未定义在这个函数中，但在函数内部进行了计算。可能是与粒子动量或概率有关的一个参数。</li> <li><code>PMAX[CurrentLayer]</code>: 当前层中的最大动量或概率。</li> <li><code>CurrentLayer</code>: 当前所在的层编号。</li> <li><code>LayerElementNo[CurrentLayer]</code>: 当前层包含的元素（原子）种类数量。</li> <li><code>CurrentElement</code>: 当前正在考虑的元素（原子）的编号。</li> <li><code>TargetAtomConc[CurrentLayer][CurrentElement]</code>: 当前层和元素对应的原子浓度或概率。</li> <li><code>ReducedCollEnergy</code>: 表示与被选中的原子碰撞后的&quot;减少的&quot;能量。</li> <li><code>FItemp[CurrentLayer][CurrentElement]</code>: 与当前层和元素有关的一个因子，用于计算<code>ReducedCollEnergy</code>。</li> <li><code>E</code>: 未定义在这个函数中，但用于计算<code>ReducedCollEnergy</code>，可能是粒子的能量。</li> <li><code>B</code>: 另一个与碰撞有关的参数。</li> <li><code>ScreenLen[CurrentLayer][CurrentElement]</code>: 与当前层和元素有关的一个参数，用于计算<code>B</code>。</li> <li><code>TargetAtomNumber[CurrentLayer][CurrentElement]</code>: 返回的是当前层和元素对应的目标原子的编号。</li></ul> <h3 id="使用到的变量-2"><a href="#使用到的变量-2" class="header-anchor">#</a> 使用到的变量：</h3> <p><code>PMAX</code>, <code>FItemp</code>, <code>E</code>, <code>ScreenLen</code></p> <h3 id="改变的变量"><a href="#改变的变量" class="header-anchor">#</a> 改变的变量：</h3> <p><code>P</code>, <code>ReducedCollEnergy</code>, <code>B</code></p> <h2 id="_3-eleenergyloss"><a href="#_3-eleenergyloss" class="header-anchor">#</a> 3. <code>EleEnergyLoss()</code></h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">EleEnergyLoss</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> Ion_Se<span class="token punctuation">;</span>

	IE <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span>E <span class="token operator">/</span> IonEnergyKeV <span class="token operator">+</span> <span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>IE <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		SEE <span class="token operator">=</span> SE<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>IE<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>E <span class="token operator">&lt;</span> IonEnergyKeV<span class="token punctuation">)</span>
		SEE <span class="token operator">=</span> SE<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>E <span class="token operator">/</span> IonEnergyKeV<span class="token punctuation">)</span><span class="token punctuation">;</span>
	DEE <span class="token operator">=</span> IonFreeLength <span class="token operator">*</span> SEE<span class="token punctuation">;</span>
	Ion_Se <span class="token operator">=</span> DEE<span class="token punctuation">;</span>
	<span class="token keyword">return</span> Ion_Se<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>double Ion_Se</code>: 存储电子或离子的能量损失。</li> <li><code>IE</code>: 一个与离子或粒子能量<code>E</code>有关的整数变量。</li> <li><code>E</code>: 离子或粒子的能量，未在此函数内定义。</li> <li><code>IonEnergyKeV</code>: 离子能量的一个特定单位（千电子伏特，KeV）。</li> <li><code>SEE</code>: 与离子或粒子能量损失有关的一个参数。</li> <li><code>SE[CurrentLayer][IE]</code>: 当前层和能量级对应的能量损失率。</li> <li><code>DEE</code>: 实际能量损失，是<code>IonFreeLength</code>（离子的自由路径长度）和<code>SEE</code>（能量损失率）的乘积。</li></ul> <h3 id="使用的变量"><a href="#使用的变量" class="header-anchor">#</a> 使用的变量：</h3> <p><code>E</code>, <code>IonEnergyKeV</code>, <code>SE</code>, <code>IonFreeLength</code></p> <h3 id="改变的变量-2"><a href="#改变的变量-2" class="header-anchor">#</a> 改变的变量：</h3> <p><code>DEE</code>,</p> <h2 id="_4-emissionangle"><a href="#_4-emissionangle" class="header-anchor">#</a> 4. <code>EmissionAngle()</code></h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">EmissionAngle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> AngleValue<span class="token punctuation">,</span> R<span class="token punctuation">,</span> Q<span class="token punctuation">;</span>
	<span class="token comment">// using the magic method</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>ReducedCollEnergy <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		R <span class="token operator">=</span> B<span class="token punctuation">;</span>
		RR <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2.7</span> <span class="token operator">*</span> <span class="token function">log</span><span class="token punctuation">(</span>ReducedCollEnergy <span class="token operator">*</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>RR <span class="token operator">&gt;=</span> B<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			RR <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2.7</span> <span class="token operator">*</span> <span class="token function">log</span><span class="token punctuation">(</span>ReducedCollEnergy <span class="token operator">*</span> RR<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>RR <span class="token operator">&gt;=</span> B<span class="token punctuation">)</span>
				R <span class="token operator">=</span> RR<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			EX1 <span class="token operator">=</span> <span class="token number">0.18175</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.1998</span> <span class="token operator">*</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
			EX2 <span class="token operator">=</span> <span class="token number">0.50986</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.94229</span> <span class="token operator">*</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
			EX3 <span class="token operator">=</span> <span class="token number">0.28022</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.4029</span> <span class="token operator">*</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
			EX4 <span class="token operator">=</span> <span class="token number">0.028171</span> <span class="token operator">*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.20162</span> <span class="token operator">*</span> R<span class="token punctuation">)</span><span class="token punctuation">;</span>
			V <span class="token operator">=</span> <span class="token punctuation">(</span>EX1 <span class="token operator">+</span> EX2 <span class="token operator">+</span> EX3 <span class="token operator">+</span> EX4<span class="token punctuation">)</span> <span class="token operator">/</span> R<span class="token punctuation">;</span>
			V1 <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>V <span class="token operator">+</span> <span class="token number">3.1998</span> <span class="token operator">*</span> EX1 <span class="token operator">+</span> <span class="token number">0.94229</span> <span class="token operator">*</span> EX2 <span class="token operator">+</span> <span class="token number">0.4092</span> <span class="token operator">*</span> EX3 <span class="token operator">+</span> <span class="token number">0.20162</span> <span class="token operator">*</span> EX4<span class="token punctuation">)</span> <span class="token operator">/</span> R<span class="token punctuation">;</span>

			FR <span class="token operator">=</span> B <span class="token operator">*</span> B <span class="token operator">/</span> R <span class="token operator">+</span> V <span class="token operator">*</span> R <span class="token operator">/</span> ReducedCollEnergy <span class="token operator">-</span> R<span class="token punctuation">;</span>
			FR1 <span class="token operator">=</span> <span class="token operator">-</span>B <span class="token operator">*</span> B <span class="token operator">/</span> <span class="token punctuation">(</span>R <span class="token operator">*</span> R<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>V <span class="token operator">+</span> V1 <span class="token operator">*</span> R<span class="token punctuation">)</span> <span class="token operator">/</span> ReducedCollEnergy <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
			Q <span class="token operator">=</span> FR <span class="token operator">/</span> FR1<span class="token punctuation">;</span>
			R <span class="token operator">=</span> R <span class="token operator">-</span> Q<span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>Q <span class="token operator">/</span> R<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		ROC <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span>ReducedCollEnergy <span class="token operator">-</span> V<span class="token punctuation">)</span> <span class="token operator">/</span> V1<span class="token punctuation">;</span>
		SQE <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>ReducedCollEnergy<span class="token punctuation">)</span><span class="token punctuation">;</span>
		CC <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.011615</span> <span class="token operator">+</span> SQE<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">0.0071222</span> <span class="token operator">+</span> SQE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		AA <span class="token operator">=</span> <span class="token number">2.0</span> <span class="token operator">*</span> ReducedCollEnergy <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0.99229</span> <span class="token operator">/</span> SQE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> CC<span class="token punctuation">)</span><span class="token punctuation">;</span>
		FF <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>AA <span class="token operator">*</span> AA <span class="token operator">+</span> <span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token operator">-</span> AA<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">9.3066</span> <span class="token operator">+</span> ReducedCollEnergy<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">14.813</span> <span class="token operator">+</span> ReducedCollEnergy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		DELTA <span class="token operator">=</span> <span class="token punctuation">(</span>R <span class="token operator">-</span> B<span class="token punctuation">)</span> <span class="token operator">*</span> AA <span class="token operator">*</span> FF <span class="token operator">/</span> <span class="token punctuation">(</span>FF <span class="token operator">+</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		CO <span class="token operator">=</span> <span class="token punctuation">(</span>B <span class="token operator">+</span> DELTA <span class="token operator">+</span> ROC<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>R <span class="token operator">+</span> ROC<span class="token punctuation">)</span><span class="token punctuation">;</span>
		C2 <span class="token operator">=</span> CO <span class="token operator">*</span> CO<span class="token punctuation">;</span>
		S2 <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> C2<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>S2 <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%d  %lf\n&quot;</span><span class="token punctuation">,</span> ElapsedIonNo<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
		CT <span class="token operator">=</span> <span class="token number">2.0</span> <span class="token operator">*</span> C2 <span class="token operator">-</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
		ST <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> CT <span class="token operator">*</span> CT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// using the RusefScattering methods</span>
	<span class="token keyword">else</span><span class="token punctuation">{</span>
		S2 <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> B <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*</span> ReducedCollEnergy <span class="token operator">*</span> B<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*</span> ReducedCollEnergy <span class="token operator">*</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>S2 <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%d  %lf\n&quot;</span><span class="token punctuation">,</span> ElapsedIonNo<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">;</span>
		C2 <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> S2<span class="token punctuation">;</span>
		CT <span class="token operator">=</span> <span class="token number">2.0</span> <span class="token operator">*</span> C2 <span class="token operator">-</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
		ST <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> CT <span class="token operator">*</span> CT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	AngleValue <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>CT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> AngleValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用的变量-2"><a href="#使用的变量-2" class="header-anchor">#</a> 使用的变量：</h3> <p><code>ReducedCollEnergy</code>, <code>B</code>,</p> <h3 id="改变的变量-3"><a href="#改变的变量-3" class="header-anchor">#</a> 改变的变量：</h3> <p><code>RR</code>, <code>ST</code>, <code>S2</code>, <code>CT</code>,</p> <h2 id="_5-ionnewcondition"><a href="#_5-ionnewcondition" class="header-anchor">#</a> 5. <code>IonNewCondition()</code></h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">double</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">IonNewCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">double</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X1<span class="token punctuation">;</span> <span class="token comment">// MAX is not OK!!!!!!!!!!!!!!!!!!!!!!!!!</span>
	<span class="token keyword">float</span> tempvalue<span class="token punctuation">;</span>

	DEN <span class="token operator">=</span> recoilfactor<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span> <span class="token operator">*</span> S2 <span class="token operator">*</span> E<span class="token punctuation">;</span>
	E <span class="token operator">=</span> E <span class="token operator">-</span> DEN <span class="token operator">-</span> DEE<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>DEE <span class="token operator">&gt;</span> MAX<span class="token punctuation">)</span>
		MAX <span class="token operator">=</span> DEE<span class="token punctuation">;</span>
	IonWayLength <span class="token operator">=</span> IonWayLength <span class="token operator">+</span> IonFreeLength <span class="token operator">-</span> DistanceNuclear<span class="token punctuation">;</span>

	X <span class="token operator">=</span> X <span class="token operator">+</span> <span class="token punctuation">(</span>IonFreeLength <span class="token operator">-</span> DistanceNuclear<span class="token punctuation">)</span> <span class="token operator">*</span> COSIN<span class="token punctuation">;</span>
	Y <span class="token operator">=</span> Y <span class="token operator">+</span> <span class="token punctuation">(</span>IonFreeLength <span class="token operator">-</span> DistanceNuclear<span class="token punctuation">)</span> <span class="token operator">*</span> COSY<span class="token punctuation">;</span>

	I <span class="token operator">=</span> <span class="token function">AMIN1</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>X <span class="token operator">/</span> channelwidth<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	J <span class="token operator">=</span> <span class="token function">AMIN1</span><span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>Y <span class="token operator">/</span> channelwidth<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">50.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ALPHA <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Y <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		J <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

	tempvalue <span class="token operator">=</span> <span class="token function">PKURandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	PHI <span class="token operator">=</span> <span class="token number">2.0</span> <span class="token operator">*</span> PI <span class="token operator">*</span> tempvalue<span class="token punctuation">;</span>

	PSI <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>ST <span class="token operator">/</span> <span class="token punctuation">(</span>CT <span class="token operator">+</span> M1_to_M2<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">[</span>CurrentElement<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>PSI <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		PSI <span class="token operator">=</span> PSI <span class="token operator">+</span> PI<span class="token punctuation">;</span>
	X1 <span class="token operator">=</span> <span class="token operator">-</span>COSIN <span class="token operator">*</span> COSY <span class="token operator">/</span> <span class="token punctuation">(</span>SINE <span class="token operator">*</span> SINY <span class="token operator">+</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fabs</span><span class="token punctuation">(</span>X1<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1.0</span><span class="token punctuation">)</span>
		X1 <span class="token operator">=</span> X1 <span class="token operator">/</span> <span class="token function">fabs</span><span class="token punctuation">(</span>X1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	DELTA <span class="token operator">=</span> PHI <span class="token operator">-</span> <span class="token function">acos</span><span class="token punctuation">(</span>X1<span class="token punctuation">)</span><span class="token punctuation">;</span>

	COSIN <span class="token operator">=</span> COSIN <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>PSI<span class="token punctuation">)</span> <span class="token operator">+</span> SINE <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>PSI<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>PHI<span class="token punctuation">)</span><span class="token punctuation">;</span>
	COSY <span class="token operator">=</span> COSY <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>PSI<span class="token punctuation">)</span> <span class="token operator">+</span> SINY <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>PSI<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>DELTA<span class="token punctuation">)</span><span class="token punctuation">;</span>

	SINY <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> COSY <span class="token operator">*</span> COSY<span class="token punctuation">)</span><span class="token punctuation">;</span>
	SINE <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> COSIN <span class="token operator">*</span> COSIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用的变量-3"><a href="#使用的变量-3" class="header-anchor">#</a> 使用的变量：</h3> <p><code>recoilfactor</code>, <code>DistanceNuclear</code>, <code>IonFreeLength</code>, <code>channelwidth</code>, <code>ALPHA</code>, <code>M1_to_M2</code>,</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>channelwidth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		channelwidth <span class="token operator">=</span> <span class="token number">0.01</span> <span class="token operator">*</span> LayertoSurface<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// for recording, the total sample are dividied into 100 segment</span>
</code></pre></div><h3 id="改变的变量-4"><a href="#改变的变量-4" class="header-anchor">#</a> 改变的变量：</h3> <p><code>DEN</code>, <code>E</code>, <code>IonWayLength</code>, <code>COSIN</code>, <code>COSY</code>, <code>X</code>, <code>Y</code>, <code>I</code>, <code>J</code>, <code>PHI</code>, <code>PSI</code>, <code>SINE</code>, <code>SINY</code>, <code>DELTA</code>,</p> <h2 id="_6-processrecorder"><a href="#_6-processrecorder" class="header-anchor">#</a> 6. <code>ProcessRecorder()</code></h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">ProcessRecorder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>

	<span class="token keyword">double</span> EPSD<span class="token punctuation">,</span> EN<span class="token punctuation">;</span>

	<span class="token comment">// total energy</span>
	MTOT<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">=</span> MTOT<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">+</span> DEN <span class="token operator">+</span> DEE<span class="token punctuation">;</span>

	<span class="token comment">// the nuclear energy loss treamting process</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>DEN <span class="token operator">&lt;</span> DisEnergy<span class="token punctuation">)</span>
		PhoneEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> PhoneEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> DEN<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		EPSD <span class="token operator">=</span> DamageEFract<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">*</span> DEN<span class="token punctuation">;</span>

		<span class="token comment">// Modified Kinchin-Pease  model</span>
		EN <span class="token operator">=</span> DEN <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> ElectronEFract<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>EPSD <span class="token operator">+</span> <span class="token number">0.4</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>EPSD<span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3.4</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>EPSD<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">6.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>EN <span class="token operator">&lt;</span> DisEnergy<span class="token punctuation">)</span>
			PhoneEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> PhoneEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> DEN<span class="token punctuation">;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>

			MVAC<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">=</span> MVAC<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
			IVAC<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> IVAC<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>EN <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//!!!!</span>
				RPHON<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> RPHON<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> EN <span class="token operator">-</span> DisEnergy<span class="token punctuation">;</span>

			<span class="token comment">// Multi-defect production!</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>EN <span class="token operator">&gt;=</span> <span class="token number">2.5</span> <span class="token operator">*</span> DisEnergy<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				MVAC<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">=</span> MVAC<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1.0</span> <span class="token operator">+</span> <span class="token number">0.4</span> <span class="token operator">*</span> EN <span class="token operator">/</span> DisEnergy<span class="token punctuation">;</span>
				RPHON<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> RPHON<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> DisEnergy <span class="token operator">-</span> <span class="token number">0.4</span> <span class="token operator">*</span> EN<span class="token punctuation">;</span>
				RVAC<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> RVAC<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1.0</span> <span class="token operator">+</span> <span class="token number">0.4</span> <span class="token operator">*</span> EN <span class="token operator">/</span> DisEnergy<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			MION<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">=</span> MION<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">+</span> DEN <span class="token operator">-</span> EN<span class="token punctuation">;</span>
			RION<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> RION<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> DEN <span class="token operator">-</span> EN<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// eletric energy loss treating process</span>
	IonizatinEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">=</span> IonizatinEDis<span class="token punctuation">[</span>I<span class="token punctuation">]</span> <span class="token operator">+</span> DEE<span class="token punctuation">;</span>

	MION<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">=</span> MION<span class="token punctuation">[</span>I <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>J<span class="token punctuation">]</span> <span class="token operator">+</span> DEE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用的变量-4"><a href="#使用的变量-4" class="header-anchor">#</a> 使用的变量：</h3> <p><code>I</code>, <code>J</code>, <code>DEN</code>, <code>DEE</code>, <code>DisEnergy</code>, <code>DamageEFract</code>, <code>ElectronEFract</code>,</p> <h3 id="改变的变量-5"><a href="#改变的变量-5" class="header-anchor">#</a> 改变的变量：</h3> <p><code>MTOT</code>, <code>PhoneEDis</code>, <code>MVAC</code>, <code>IVAC</code>, <code>RPHON</code>, <code>RVAC</code>, <code>MION</code>, <code>RION</code>, <code>IonizatinEDis</code>,</p> <h2 id="_7-outornot-int-ionflag"><a href="#_7-outornot-int-ionflag" class="header-anchor">#</a> 7. <code>OutOrNot(int &amp;Ionflag)</code></h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token class-name">PKU_MC</span><span class="token double-colon punctuation">::</span><span class="token function">OutOrNot</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>Ionflag<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		Ionflag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;=</span> LayertoSurface<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			CurrentLayer <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&lt;=</span> LayertoSurface<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
			CurrentLayer <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			CurrentLayer <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>X <span class="token operator">&gt;=</span> LayertoSurface<span class="token punctuation">[</span>CurrentLayer<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Ionflag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>E <span class="token operator">&lt;=</span> StoppingEnergy<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		Ionflag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用的变量-5"><a href="#使用的变量-5" class="header-anchor">#</a> 使用的变量：</h3> <p><code>X</code>, <code>LayertoSurface</code>, <code>StoppingEnergy</code>, <code>E</code>,</p> <h3 id="改变的变量-6"><a href="#改变的变量-6" class="header-anchor">#</a> 改变的变量：</h3> <p><code>Ionflag</code>,</p> <h1 id="一些注意点"><a href="#一些注意点" class="header-anchor">#</a> 一些注意点</h1> <ol><li>while 大循环内部其实就是一个 step，那这些 step 里使用到的变量应该是继承在 event 里一直用的，但是在 event 结束后这些变量在哪里初始化的</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/Research/Research/2023-Geant4/2023.08.28-Geant4自定义PhysicsList.html" class="prev">
        2023.08.28-Geant4 自定义 PhysicsList
      </a></span> <span class="next"><a href="/Blog/Research/Research/2023-Geant4/2023.12.18-Geant4自动化.html">
        2023.12.18-Geant4自动化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog/assets/js/app.fffc62c2.js" defer></script><script src="/Blog/assets/js/2.d9b38520.js" defer></script><script src="/Blog/assets/js/1.a4e52cf6.js" defer></script><script src="/Blog/assets/js/106.72dc4a51.js" defer></script>
  </body>
</html>
